!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t),r.d(t,"Salesforce",(function(){return n}));class n{constructor(e){this.user=null,this.tokenData=null,this.nsPrefix="",this.setConfig(e)}setNsPrefix(e){return this.nsPrefix=e,e}setUser(e){this.user=e}setConfig(e){return this.config=e,e}setTokenData(e){return this.tokenData=e,e}authUrl(){const{authUrl:e,clientId:t,callbackUrl:r}=this.config;return`${e}?response_type=token&client_id=${t}&redirect_uri=${encodeURIComponent(r)}`}tokenFromUrl(e){const t=e.split("#")[1],r=decodeURIComponent(t).split("&").reduce((e,t)=>{const[r,n]=t.split("=");return{...e,[r]:n}},{});return this.setTokenData(r),r}toQueryUrl(e){const{apiVersion:t}=this.config,r=`services/data/${t}/query?q=${encodeURI(e).replace(/%20/g,"+")}`;return`${this.tokenData.instance_url}/${r}`}profileQuery(e){const t=`SELECT Id, Email, Username, FirstName, LastName, Name, SmallPhotoUrl  FROM User WHERE Id = '${e}'`;return this.toQueryUrl(t)}idFromUrl(e){return e.split("/").pop()}fetch(e){const t={Authorization:"Bearer "+this.tokenData.access_token};return fetch(e,{headers:t}).then(e=>e.json())}async getProfile(e=null){const t=e||this.tokenData;if(!t)throw new Error("Please set a tokenData");const r=this.idFromUrl(t.id);try{const e=this.profileQuery(r),t=(await this.fetch(e)).records[0];return this.user=t,t}catch(e){throw new Error(e)}}clearData(){this.tokenData=null,this.user=null}nsPrefixQuery(){return"SELECT NamespacePrefix FROM ApexClass WHERE Name='VlocityOrganization'"}lwcUri(e,t){const{componentName:r,defaultNs:n=!1,lwcAttrs:o={},methods:s=[],iframeId:i=null,vfns:a=null,refs:c=null}=e;if(!this.tokenData)return null;const u=t||"JsSdkMobileLwcPreviewPage2",l=JSON.stringify({lwc:r,ns:n?"c":this.nsPrefix,vfns:a||this.nsPrefix,methods:s,iframeId:i,refs:c,...o}).replace(/'/g,"%22").replace(/#/g,"%23").replace(/>/g,"%3E").replace(/ /g,"%2B");return`${this.tokenData.instance_url}/apex/${u}?data=${l}`}omniOutUri(e,t=null){const{omniScriptType:r,subType:n,language:o}=e,s=t||"OmniScriptUniversalPage";return`${`${this.tokenData.instance_url}/apex/${s}`}?OmniScriptType=${r}&OmniScriptSubType=${n}&OmniScriptLang=${o}`}cardsOutUri(e){const{layout:t,layoutId:r,ns:n,params:o}=e,s=(()=>{if(o){return"&"+Object.entries(o).reduce((e,t)=>{const r=`${t[0]}=${t[1]}`;return e?"&"+r:r},"")}return!1})(),i=n||this.nsPrefix;return`${this.tokenData.instance_url+"/apex/ConsoleCards"}?layout=${t}&layoutId=${r}&previewMode=Universal&ns=${i}${s}`}frontDoor(e){if(!this.tokenData)return null;return`${this.tokenData.instance_url}/secur/frontdoor.jsp?sid=${this.tokenData.access_token}&retURL=${e}`}async fetchNsPrefix(){try{const e=await this.fetch(this.toQueryUrl(this.nsPrefixQuery()));return this.setNsPrefix(e.records[0].NamespacePrefix),e}catch(e){return null}}cookieUrls(){const e=this.tokenData.instance_url.split(".")[0];return[e+".content.force.com",e+".force.com",e+".salesforce.com",e+".my.salesforce.com",e+".lightning.force.com",e+"--c.documentforce.com","https://*.salesforce.com","https://*.force.com","https://*.documentforce.com","https://*.visualforce.com","https://*.visual.force.com"]}refreshTokenData(){const{clientId:e,clientSecret:t}=this.config;return`grant_type=refresh_token&client_id=${e}&client_secret=${t}&refresh_token=${this.tokenData.refresh_token}&format=json`}async requestRefreshToken(){const e=this.refreshTokenData(),t=await fetch("https://login.salesforce.com/services/oauth2/token?grant_type=refresh_token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}),r=await t.json();return this.tokenData.access_token=r.access_token,this.tokenData}lwcIframe(e,t,r){if(!e)return!1;const n=t?"string"==typeof t?{componentName:t}:t:{componentName:e};n.componentName||(n.componentName=e);const o=document.getElementById(e);return o.src=this.lwcUri({...n,iframeId:e},r),o}async init(e){const t=this.tokenFromUrl(e);this.setTokenData(t);const r=await this.getProfile();return await this.fetchNsPrefix(),this.user=r,{nsPrefix:this.nsPrefix,tokenData:t,user:r}}}}])}));